/**
 *
 * @package   theme_mb2nl
 * @copyright 2017 - 2025 Mariusz Boloz (lmsstyle.com)
 * @license   PHP and HTML: http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later. Other parts: http://themeforest.net/licenses
 */ define(["jquery","core/ajax","theme_mb2nl/str"],function(e,o,t){"use strict";let r=()=>{e(document).on("mouseenter",".theme-course-item-inner,.course-popover",function(){let o=e(this).hasClass("course-popover")?e(this).attr("data-course"):e(this).closest(".theme-course-item").attr("data-course");if(!(e(window).width()>991))return null;s(o,e(this))}),e(document).on("mouseleave",".theme-course-item-inner,.course-popover",function(o){if(!(e(window).width()>991))return null;{let t=e(o.currentTarget).hasClass("course-popover")?e(this).attr("data-course"):e(this).closest(".theme-course-item").attr("data-course");i(t)}}),e(document).on("click",".qw-launcher",function(){if(!(991>=e(window).width()))return null;{let o=e(this).closest(".theme-course-item").attr("data-course");s(o,e(this))}}),e(document).on("click",".qw-close",function(){if(!(991>=e(window).width()))return null;{let o=e(this).closest(".course-popover").attr("data-course");i(o)}})},s=(o,t)=>{if((t.hasClass("theme-course-item-inner")||t.hasClass("qw-launcher"))&&(e(".theme-course-item-inner").removeClass("popover-pos"),t.hasClass("qw-launcher")?t.closest(".theme-course-item-inner").addClass("popover-pos"):t.addClass("popover-pos")),e(".popover-"+o).length)return n(o),p(o),null;a(o)},a=o=>{l(o).then(t=>{if(e(".popover-"+o).length)return null;e("body").append(d(o));let r=e(".popover-"+o+" .course-popover-inner");return n(o),p(o),setTimeout(function(){r.append(t.content),r.removeClass("loading")},200),!0}).catch(e=>{require(["core/log"],function(o){o.debug(e)})})},l=e=>o.call([{methodname:"theme_mb2nl_course_quickview",args:{courseid:e}}])[0],i=o=>{e(".course-popover.popover-"+o).removeClass("open"),e(".course-popover.popover-"+o).removeAttr("aria-modal"),e(".course-popover.popover-"+o).attr("aria-hidden","true")},p=o=>{e(".course-popover").removeClass("open"),e(".course-popover").removeAttr("aria-modal"),e(".course-popover.popover-"+o).addClass("open"),e(".course-popover.popover-"+o).removeAttr("aria-hidden"),e(".course-popover.popover-"+o).attr("aria-modal","true")},n=o=>{991>=e(window).width()?c(o):u(o)},u=o=>{let t=e(".popover-pos"),r=e(".popover-"+o),s=r.outerWidth(),a=e("body").hasClass("dir-rtl"),l=t.offset().top,i=t.offset().left+t.width(),p=t.offset().left-s,n=i,u="arrl";r.removeClass("arrl"),r.removeClass("arrr"),a?(n=p,u="arrr",t.offset().left-s<0&&(n=i,u="arrl")):t.offset().left+t.width()+s>e(window).width()&&(n=p,u="arrr");let c={left:n,top:l};r.addClass(u),r.css(c)},c=o=>{let t=e(".popover-pos"),r=e(".popover-"+o),s=r.outerWidth(),a=t.offset().top,l=t.offset().left+t.width()/2;l-s/2<=0?l=s/2+10:t.offset().left+s>e(window).width()&&(l=e(window).width()-(s/2+10));let i={left:l,top:a};r.css(i)},d=e=>{let o="";return o+='<div class="course-popover popover-'+e+'" data-course="'+e+'" tabindex="-1" aria-hidden="true">',o+='<div class="course-popover-inner position-relative loading">',o+='<button type="button" tabindex="-1" class="themereset qw-close p-0 position-absolute lhsmall">',o+='<span class="sr-only">'+t.get_str("closebuttontitle")+' </span><i class="bi bi-x-lg" aria-hidden="true"></i>',o+="</button>",o+="</div>",o+="</div>"};return{init:r}});