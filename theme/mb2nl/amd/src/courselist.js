/**
 *
 * @package   theme_mb2nl
 * @copyright 2017 - 2025 Mariusz Boloz (lmsstyle.com)
 * @license   PHP and HTML: http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later. Other parts: http://themeforest.net/licenses
 */ define(["jquery","core/ajax"],function(e,t){"use strict";let a=e("#page"),i=e("form.theme-course-filter .inner"),r=()=>{(()=>{let e={categoryid:a.attr("data-uparam_categoryid"),tagid:a.attr("data-uparam_tagid"),teacherid:a.attr("data-uparam_teacherid"),cfields:a.attr("data-cfields")};return t.call([{methodname:"theme_mb2nl_course_filters",args:e}])[0]})().then(e=>{i.append(e.filters),b(),c()}).catch(e=>{require(["core/log"],function(t){t.debug(e)})})},n=(a=1,i="")=>{let r=e("form.theme-course-filter"),n=r.find("[disabled]");n.removeAttr("disabled");let c=r.serialize();return n.attr("disabled","disabled"),t.call([{methodname:"theme_mb2nl_course_list",args:{formdata:c,page:a,searchstr:i}}])[0]},c=(e=0)=>{u(!0),e&&h(),n().then(e=>{d(e)}).catch(e=>{require(["core/log"],function(t){t.debug(e)})})};var s,l,o=function(){e(document).on("click",".toggle-list-btn",function(){var t=e(this).closest(".filter-form-field");t.hasClass("active")?(t.removeClass("active"),e(this).attr("aria-expanded","false")):(t.addClass("active"),e(this).attr("aria-expanded","true"))})},d=function(t){setTimeout(function(){e(f().container).empty(),e(f().container).append(t.courses),u(!1)},850)},f=function(){return{container:".courses-container-inner",courselist:".theme-courses-list"}},u=function(t){t?e(f().container).addClass("loading"):e(f().container).removeClass("loading")},h=function(){e("html, body").stop().animate({scrollTop:e(f().container).offset().top-165},650)},m=function(){e(document).on("click",".clearfilters",function(){e(".mb2filter-inpt").each(function(){e(this).prop("checked",!1),"radio"===e(this).attr("type")&&0==e(this).attr("value")&&"filter_price"!==e(this).attr("name")?e(this).prop("checked",!0):"radio"===e(this).attr("type")&&-1==e(this).attr("value")&&"filter_price"===e(this).attr("name")&&e(this).prop("checked",!0)}),e(this).addClass("mb2-hidden"),e(".filter-toggle").find(".criteria-num").remove(),c(1)})},p=function(){e(document).on("click",".filter-toggle",function(){var t=e(".cfilter-wrap");t.hasClass("active")?(t.removeClass("active"),e(this).attr("aria-expanded","false")):(t.addClass("active"),e(this).attr("aria-expanded","true"))}),e(document).on("click",".filter-close",function(){e(".cfilter-wrap").removeClass("active"),e(".filter-toggle").attr("aria-expanded","false")})},g=function(){v(),e(document).on("change",".mb2filter-inpt",function(){v(),c()})},v=function(){let t=e(".filter-toggle"),a=e(".clearfilters");var i=0;let r=(e(".mb2filter-inpt").each(function(){e(this).is(":checked")&&(e(this).val()>0||"filter_price"===e(this).attr("name")&&0==e(this).val())&&i++}),i);0==r?(t.find(".criteria-num").remove(),a.addClass("mb2-hidden")):(t.find(".criteria-num").remove(),t.append('<span class="criteria-num d-inline-flex mb2ml-1 lhsmall fwbold tsizesmall align-items-center">'+r+"</span>"),a.removeClass("mb2-hidden"))},b=function(){g(),o(),p(),m()};return{pagination:function(){e(document).on("click",".theme-courses-paginitem",function(){let t=e(f().courselist),a=e(this).attr("data-page");if(a==t.attr("data-page"))return null;u(!0),h(),n(a).then(e=>{d(e)}).catch(e=>{require(["core/log"],function(t){t.debug(e)})})})},searchCourses:function(){e(document).on("submit",".theme-course-search",function(t){t.preventDefault();var a=e(this).find("input").val().replace(/<\/?[^>]+(>|$)/g,"").toLowerCase();u(!0),h(),n(1,a).then(e=>{d(e)}).catch(e=>{require(["core/log"],function(t){t.debug(e)})})})},coursesFilters:r}});